SELECT *
FROM (
    SELECT 
        Сотрудники.ID,
        Сотрудники.Имя,
        Зарплаты.Дата,
        Зарплаты.Зарплата,
        COUNT(Повышение_квалификации.Курс) OVER (PARTITION BY Сотрудники.ID, TO_CHAR(Зарплаты.Дата, 'YYYY-MM')) AS Курсы_повышения_квалификации
    FROM 
        Сотрудники
    JOIN 
        Зарплаты ON Сотрудники.ID = Зарплаты.Сотрудник_ID
    LEFT JOIN 
        Повышение_квалификации ON Сотрудники.ID = Повышение_квалификации.Сотрудник_ID AND TO_CHAR(Зарплаты.Дата, 'YYYY-MM') = TO_CHAR(Повышение_квалификации.Дата_начала, 'YYYY-MM')
)
MODEL
    PARTITION BY (ID)
    DIMENSION BY (TO_CHAR(Дата, 'YYYY-MM') AS Месяц)
    MEASURES (Зарплата, Курсы_повышения_квалификации, 0 AS Новая_зарплата)
    RULES (
        Новая_зарплата['2024-01'] = Зарплата['2023-01'] * (1 + Курсы_повышения_квалификации['2023-01'] * 0.02),
        Новая_зарплата['2024-02'] = Зарплата['2023-02'] * (1 + Курсы_повышения_квалификации['2023-02'] * 0.02),
        -- Добавьте здесь остальные месяцы
        Новая_зарплата['2024-12'] = Зарплата['2023-12'] * (1 + Курсы_повышения_квалификации['2023-12'] * 0.02)
    )
ORDER BY 
    ID, Месяц;
